# 客资数据获取方案分析

## 测试结果总结

### 已测试的接口（全部失败）

| 接口路径 | 状态 | 错误信息 |
|---------|------|---------|
| `/open_api/2/tools/clue/get/` | ❌ | advertiser ID required |
| `/open_api/2/tools/clue/form/get/` | ❌ | Account doesn't exist |
| `/open_api/v3.0/clue/get/` | ❌ | 404 |
| `/open_api/v3.0/local/clue/get/` | ❌ | 404 |
| `/open_api/v3.0/local/push/leads/get/` | ❌ | 404 |
| `/open_api/v3.0/local/leads/list/` | ❌ | 404 |
| `/open_api/v3.0/leads/get/` | ❌ | 404 |

### 权限状态

✅ 已授权权限码：
- `10000000` - 未知（新增）
- `2`, `5`, `8` - 未知（新增）
- `130` - 工具-线索管理
- `100000014` - 本地推
- 其他常规权限

## 问题分析

### 可能的原因

1. **接口路径变更**
   - 巨量引擎API文档可能已更新
   - v2接口可能已废弃
   - v3接口路径不正确

2. **账户类型问题**
   - 你的账户可能没有客资数据
   - 或者客资在另一个系统（抖音来客）

3. **权限配置问题**
   - 虽然有权限码130，但可能需要在后台单独开通
   - 或者需要特定的应用类型

## 验证步骤

### 第一步：确认是否有客资数据

**在巨量引擎后台检查：**

1. 登录 https://ad.oceanengine.com
2. 进入"工具" → "线索管理" 或 "客资管理"
3. 查看是否能看到客资数据
4. 如果能看到，记录一条客资的详细信息（特别是ad_id）

**关键问题：**
- ❓ 能否在后台看到"线索管理"菜单？
- ❓ 能否看到客资数据？
- ❓ 客资数据里是否有"广告单元ID"字段？

### 第二步：确认数据来源

**客资可能来自两个地方：**

| 来源 | 说明 | 获取方式 |
|-----|------|---------|
| **本地推广告** | 通过广告投放获得的客资 | 巨量引擎API |
| **自然流量** | 抖音来客店铺自然流量 | 抖音来客API |

**验证方法：**
- 在巨量后台查看客资来源标签
- 如果标注"广告"，应该能通过巨量API获取
- 如果标注"自然流量"，需要抖音来客API

## 三个可行方案

### 方案1：手动导出（最快）

**优点：**
- 立即可用，无需等待
- 可以先验证数据关联逻辑

**步骤：**
1. 在巨量后台导出客资数据（Excel）
2. 我写脚本解析Excel
3. 通过ad_id关联到投放数据
4. 上传到飞书

**需要你提供：**
- 导出的客资Excel文件
- 确认Excel中有ad_id（单元ID）字段

### 方案2：申请抖音来客API（最完整）

**优点：**
- 数据最全（包含自然流量客资）
- 自动化程度高

**步骤：**
1. 访问 https://open-life.douyin.com
2. 创建应用，申请 `goodlife.leads` 权限
3. 等待审核（1-3天）
4. 获取配置后我帮你实现

**需要确认：**
- 你是否有抖音来客商家后台访问权限
- 是否愿意等待1-3天审核

### 方案3：继续排查巨量API（不确定）

**可能的方向：**
1. 联系巨量引擎技术支持，确认正确的接口路径
2. 检查应用类型是否正确（可能需要特定类型才能访问客资）
3. 尝试在开发者社区寻找最新的API文档

## 我的建议

**优先级排序：**

1. **立即做：** 确认巨量后台是否有客资数据
   - 如果有 → 先用方案1（手动导出）快速实现
   - 如果没有 → 说明客资在抖音来客系统

2. **同时进行：** 申请抖音来客API（方案2）
   - 即使巨量有数据，来客API也能获取更全面的信息
   - 审核期间可以先用方案1

3. **备选：** 如果前两个都不行，再深入排查巨量API（方案3）

## 下一步行动

**请你回答以下问题：**

1. 能否在巨量后台看到"线索管理"或"客资管理"菜单？
2. 如果能看到，里面有数据吗？
3. 数据里是否有"广告单元ID"或"ad_id"字段？
4. 你是否有抖音来客商家后台的访问权限？
5. 你倾向于先用哪个方案？

根据你的回答，我会立即提供对应的实现代码。
