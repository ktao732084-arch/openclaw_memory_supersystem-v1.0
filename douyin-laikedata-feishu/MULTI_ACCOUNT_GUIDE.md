# 多账户数据同步说明

## 当前情况

根据 API 测试结果：
- ✅ 当前授权可以访问 **1个本地推账户**（ID: 1835880409219083）
- ✅ 该账户下有 **93个项目**
- ❌ 无法通过 API 自动获取其他账户列表

## 可能的原因

### 1. 确实只有1个本地推账户
- 你提到的"70多个账户"可能是指"项目"而不是"账户"
- 巨量引擎的层级结构：广告主 → 本地推账户 → 项目 → 单元
- 当前账户下有93个项目，符合"70多个"的描述

### 2. 有多个账户但未授权
- 如果确实有多个本地推账户，可能需要：
  - 在巨量后台分别授权每个账户
  - 或者使用更高级别的权限

### 3. 账户在不同的广告主下
- 如果账户属于不同的广告主（不同公司/主体）
- 需要分别授权每个广告主

## 如何确认账户数量

### 方法1: 巨量后台查看
1. 登录巨量引擎后台
2. 进入"本地推"模块
3. 查看左侧账户列表
4. 截图或记录所有账户ID

### 方法2: 联系巨量客服
- 咨询技术支持
- 确认当前主体下有多少个本地推账户
- 确认 API 权限范围

## 多账户数据同步方案

### 方案A: 手动配置账户ID（推荐）

如果你能提供所有账户ID，我们可以批量获取数据。

**步骤**:
1. 在巨量后台获取所有账户ID
2. 编辑 `multi_account_sync.py`
3. 在 `ACCOUNT_IDS` 列表中添加所有ID：
   ```python
   ACCOUNT_IDS = [
       1835880409219083,  # 账户1
       1234567890123456,  # 账户2
       1234567890123457,  # 账户3
       # ... 更多账户
   ]
   ```
4. 运行脚本：`python3 multi_account_sync.py`

**优点**:
- 简单直接
- 不需要额外授权
- 可以灵活控制同步哪些账户

**缺点**:
- 需要手动维护账户列表
- 新增账户需要手动添加

### 方案B: 分别授权每个账户

如果账户需要单独授权：

**步骤**:
1. 为每个账户创建独立的授权
2. 获取每个账户的 Access Token
3. 分别调用 API 获取数据
4. 合并数据后上传飞书

**优点**:
- 权限隔离
- 更安全

**缺点**:
- 配置复杂
- 需要管理多个 Token

### 方案C: 使用账户维度报表

如果 API 支持获取所有账户的汇总数据：

**步骤**:
1. 调用账户维度报表接口
2. 一次性获取所有账户数据
3. 上传到飞书

**优点**:
- 最简单
- 自动包含所有账户

**缺点**:
- 目前测试该接口返回空数据
- 可能需要特殊权限

## 测试脚本

### 1. 测试单个账户
```bash
cd /root/.openclaw/workspace/douyin-laikedata-feishu
python3 sync_data.py
```

### 2. 测试多个账户
```bash
# 编辑 multi_account_sync.py，添加账户ID
python3 multi_account_sync.py
```

### 3. 探索账户结构
```bash
python3 final_account_test.py
```

## 下一步建议

### 立即可做
1. **确认账户数量**
   - 登录巨量后台
   - 查看"本地推"账户列表
   - 确认是"账户"还是"项目"

2. **如果确实有多个账户**
   - 提供所有账户ID
   - 我们配置 `multi_account_sync.py`
   - 测试批量获取

3. **如果只有1个账户**
   - 当前方案已经完美工作
   - 93个项目的数据都能获取
   - 无需修改

### 需要更多信息
- 巨量后台账户列表截图
- 或者账户ID列表
- 或者确认"70多个"是指项目还是账户

## 常见问题

### Q: 为什么 API 只返回1个账户？
**A**: 可能原因：
1. 确实只有1个本地推账户
2. 其他账户需要单独授权
3. API 权限不足

### Q: 如何获取账户ID？
**A**: 
1. 巨量后台 → 本地推 → 账户列表
2. 每个账户都有唯一的数字ID
3. 或者联系巨量客服

### Q: 多账户数据会重复吗？
**A**: 不会。每个单元ID是全局唯一的，不同账户的单元ID不会重复。

### Q: 可以自动发现新账户吗？
**A**: 目前 API 不支持。需要手动添加账户ID到配置文件。

## 技术支持

如果需要帮助：
1. 提供巨量后台账户列表截图
2. 或提供账户ID列表
3. 我们可以配置批量同步

---

**总结**: 目前可以访问1个账户（93个项目）。如果确认有多个账户，请提供账户ID列表，我们可以实现批量同步。
